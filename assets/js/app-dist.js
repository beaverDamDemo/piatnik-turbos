"use strict";function updateCardLengthGraphicView(s,a){$("#cardADeep").empty();for(var e=0;e<s-1;e++)$("#cardADeep").append("<div class='inner' style='z-index:"+(32-e)+"; transform: translate("+2*e+"px, "+2*e+"px)'></div>");$("#cardBDeep").empty();for(var t=0;t<a-1;t++)$("#cardBDeep").append("<div class='inner' style='z-index:"+(32-t)+"; transform: translate("+2*t+"px, "+2*t+"px)'></div>")}function fillUpcars(){function s(s,a,e,t,c,i,r,n,d){this.id=s,this.name=a,this.zyl=e,this.kw=t,this.ccm=c,this.kmh=i,this.img=r,this.firstChoice=n,this.secondChoice=d,this.duelsWon=0,this.duelsLost=0,this.duelsTie=0,this.toString=function(){return this.name+" "+this.id+" "+this.zyl+" "+this.kw+" "+this.ccm+" "+this.kmh},this.addDuelResult=function(s){"tie"==s?this.duelsTie++:"win"==s?this.duelsWon++:this.duelsLost++},this.getDuelStats=function(){return"won: "+this.duelsWon+", tie: "+this.duelsTie+", lost: "+this.duelsLost}}var a=[],e=new s("1A","Toyota Celica 4 WD",4,150,1998,230,"assets/images/cars/toyota_celica.jpeg",2,3),t=new s("1B","Porsche 939 Turbo",4,221,3300,260,"assets/images/cars/p939.jpg",2,1),c=new s("1C","Opel Manta",4,110,1956,216.8,"assets/images/cars/opel_manta.jpg",3,0),i=new s("1D","Bmw 745i",6,185,3430,228,"assets/images/cars/bmw745.jpg",2,2),r=new s("2A","Porsche 924 Carrera GT",4,154.5,1984,237,"assets/images/cars/p924.jpg",3,0),n=new s("2B","Saab 900",4,107,1985,195,"assets/images/cars/saab900.jpg",0,2),d=new s("2C","Mitsubishi Cordia",4,84,1597,184,"assets/images/cars/mitsubishi_cordia.jpg",0,2),o=new s("2D","Renault 5",4,118,1397,210,"assets/images/cars/renault5.jpg",0,3),l=new s("3A","MG Metro",4,69,1275,180,"assets/images/cars/mg_metro.jpg",0,0),u=new s("3B","Ford Capri",6,138,2793,210,"assets/images/cars/ford.jpg",2,0),m=new s("3C","Mitsubishi Starion",4,125,1996,220,"assets/images/cars/mitsubishi_starion.jpg",0,3),h=new s("3D","Audi Quattro",5,147,2144,220,"assets/images/cars/audi_quattro.jpg",0,2),p=new s("4A","Mazda RX7",2,122,2292,225,"assets/images/cars/mazda_rx7.jpg",2,3),g=new s("4A","Porsche C.",6,213,2687,165,"assets/images/cars/911c.jpg",0,1),$=new s("4C","Citroen CX GTI",4,124,2500,220,"assets/images/cars/citroen_cx.jpg",2,0),f=new s("4D","Audi 100",5,121,2228,213,"assets/images/cars/audi_100.jpg",0,2),w=new s("5A","Lotus Esprit S3",4,156,2172,244.6,"assets/images/cars/lotus_esprit.jpg",3,0),v=new s("5B","TVR 100",6,169,3e3,230,"assets/images/cars/tvr.jpg",2,0),C=new s("5C","Fiat UNO 75 i.e. Turbo Kat",4,74,1301,190,"assets/images/cars/fiat_uno.jpg",0,3),y=new s("5D","Lancia Delta HF Integrale",4,183,1981,215,"assets/images/cars/lancia_delta.jpg",1,0),k=new s("6A","Lamborghini Countach LP500S",12,276,4754,293,"assets/images/cars/countach.jpg",0,2),T=new s("6B","Ferrari 308 GTBi-K&#246nig",8,232,2927,264.7,"assets/images/cars/308.jpg",0,1),A=new s("6C","BMW 2002",4,265,1426,255,"assets/images/cars/bmw2002.jpg",1,3),B=new s("6D","Porsche 911 Turbo",6,235,3300,270,"assets/images/cars/p911.jpg",2,3),x=new s("7A","Nissan 300 ZX",6,208,2959,250,"assets/images/cars/nissan300.jpg",2,1),j=new s("7B","Alfetta GTV",4,294,1421,290,"assets/images/cars/alfetta-gtv.jpg",1,3),b=new s("7C","Porsche 934",6,441,2993,305,"assets/images/cars/porsche-934.jpg",1,3),_=new s("7D","Ford Escort",4,279,1427,270,"assets/images/cars/ford_escort.jpg",1,3),D=new s("8A","Ferrari F40",8,351,2936,324,"assets/images/cars/f40.jpg",3,3),z=new s("8B","Ferrari GTB",8,198,3185,263,"assets/images/cars/f328.jpg",0,2),M=new s("8C","Toyota Supra Katarga",6,173,2954,245,"assets/images/cars/toyota_supra.jpg",2,0),P=new s("8D","Porsche 944",4,184,2479,260,"assets/images/cars/porsche944.jpg",3,2),S=new s("1E","Dauer 962",6,552,2994,406,"assets/images/cars/dauer-962.jpg",3,1),F=new s("2E","Volvo 850 T-5R",5,181,2319,245,"assets/images/cars/volvo-850.jpg",0,1),U=new s("3E","Alfa 164 Turbo 8v",4,129,1995,225,"assets/images/cars/alfa-164.jpg",3,1),I=new s("4E","Ford Escort Cosworth",4,167,1994,232,"assets/images/cars/ford-escort-rs.jpg",2,0);return a.push(e,t,c,i,r,n,d,o,l,u,m,h,p,g,$,f,w,v,C,y,k,T,A,B,x,j,b,_,D,z,M,P),a.push(S,F,U,I),a.length=8,a}function shuffle(s){for(var a,e,t=s.length;0!==t;)e=Math.floor(Math.random()*t),a=s[t-=1],s[t]=s[e],s[e]=a;return s}function delay(a){return new Promise(function(s){setTimeout(s,a)})}function enableUserActions(){$("#cardB .val").removeClass("disabled")}function disableUserActions(){$("#cardB .val").addClass("disabled")}window.onload=function(){function e(s){window.audioCurrentlyPlaying=!1}function t(s){}function a(){0==s?($(statusText).empty(),$(statusText).append("throwing a coin..."),setTimeout(function(){Math.random()<.5?(!0,$(".coin").css("background-image",'url("assets/images/cross.png")'),$(".coin").show(),$(statusText).empty(),$(statusText).append("AI's turn... Hit enter or click me..."),$(statusText).append()):(!1,$(".coin").css("background-image",'url("assets/images/head.png")'),$(".coin").show(),$(statusText).empty(),$(statusText).append("Your turn. Hit enter or click me..."))},10),setTimeout(function(){$(".coin").hide()},100)):1==s&&(!0?i():listenToUser()),s++}function c(){function s(s){o++,$("#cardA").addClass("active"),setTimeout(function(){$("#cardA ."+s).addClass("active")},500),setTimeout(function(){n("fromUserMove")},1e3)}$("details#cara").text(m[0].getDuelStats()),$("details#carb").text(u[0].getDuelStats()),enableUserActions(),$("#cardB").addClass("active"),$(statusText).removeClass("active"),$("#cardB .zyl").unbind("click").click(function(){p=u[0].zyl,h=m[0].zyl,$("#cardB .zyl").addClass("active"),s("zyl")}),$("#cardB .kw").unbind("click").click(function(){p=u[0].kw,h=m[0].kw,$("#cardB .kw").addClass("active"),s("kw")}),$("#cardB .ccm").unbind("click").click(function(){p=u[0].ccm,h=m[0].ccm,$("#cardB .ccm").addClass("active"),s("ccm")}),$("#cardB .kmh").unbind("click").click(function(){p=u[0].kmh,h=m[0].kmh,$("#cardB .kmh").addClass("active"),s("kmh")})}function i(){$("details#cara").text(m[0].getDuelStats()),$("details#carb").text(u[0].getDuelStats()),$("#cardB").addClass("active"),disableUserActions(),$(statusText).removeClass("correct wrong active"),setTimeout(function(){$("#cardA").addClass("active")},800);var s=[m[0].zyl,m[0].kw,m[0].ccm,m[0].kmh],a=[u[0].zyl,u[0].kw,u[0].ccm,u[0].kmh];Promise.delay(function(){if(Math.random()<d)switch(h=s[m[0].firstChoice],p=a[m[0].firstChoice],m[0].firstChoice){case 0:$(statusText).empty().append("AI says: "+m[0].zyl+" zyl."),$("#cardA .zyl").addClass("active"),setTimeout(function(){$("#cardB .zyl").addClass("active")},400);break;case 1:$(statusText).empty().append("AI says: "+m[0].kw+" kW."),$("#cardA .kw").addClass("active"),setTimeout(function(){$("#cardB .kw").addClass("active")},400);break;case 2:$(statusText).empty().append("AI says: "+m[0].ccm+" ccm."),$("#cardA .ccm").addClass("active"),setTimeout(function(){$("#cardB .ccm").addClass("active")},400);break;case 3:$(statusText).empty().append("AI says: "+m[0].kmh+" km/h."),$("#cardA .kmh").addClass("active"),setTimeout(function(){$("#cardB .kmh").addClass("active")},400)}else switch(h=s[m[0].secondChoice],p=a[m[0].secondChoice],m[0].secondChoice){case 0:$(statusText).empty().append("AI says: "+m[0].zyl+" zyl."),$("#cardA .zyl").addClass("active"),setTimeout(function(){$("#cardB .zyl").addClass("active")},400);break;case 1:$(statusText).empty().append("AI says: "+m[0].kw+" kW."),$("#cardA .kw").addClass("active"),setTimeout(function(){$("#cardB .kw").addClass("active")},400);break;case 2:$(statusText).empty().append("AI says: "+m[0].ccm+" ccm."),$("#cardA .ccm").addClass("active"),setTimeout(function(){$("#cardB .ccm").addClass("active")},400);break;case 3:$(statusText).empty().append("AI says: "+m[0].kmh+" km/h."),$("#cardA .kmh").addClass("active"),setTimeout(function(){$("#cardB .kmh").addClass("active")},400)}},1150).delay(function(){$(statusText).addClass("active")},200).delay(function(){n("fromMakeAiMove")},200)}function r(){$("#cardA .id").html(m[0].id),$("#cardA .name").html(m[0].name),$("#cardA .zyl").html(m[0].zyl+" zyl"),$("#cardA .kw").html(m[0].kw+" kW"),$("#cardA .ccm").html(m[0].ccm+" ccm"),$("#cardA .kmh").html(m[0].kmh+" km/h"),$("#cardA img").attr("src",m[0].img),$("#cardB .id").html(u[0].id),$("#cardB .name").html(u[0].name),$("#cardB .zyl").html(u[0].zyl+" zyl"),$("#cardB .kw").html(u[0].kw+" kW"),$("#cardB .ccm").html(u[0].ccm+" ccm"),$("#cardB .kmh").html(u[0].kmh+" km/h"),$("#cardB img").attr("src",u[0].img)}function n(s){Promise.delay(function(){p<h?(m[0].addDuelResult("win"),u[0].addDuelResult("lose"),Math.random()<.5?(m.push(m[0]),m.push(u[0])):(m.push(u[0]),m.push(m[0])),!0,$(statusText).empty().removeClass().append("ai wins.").addClass("wrong"),$("#cardA .val.active").addClass("correct"),$("#cardB .val.active").addClass("wrong"),handleAudio("wrong_audio")):h<p?(m[0].addDuelResult("lose"),u[0].addDuelResult("win"),Math.random()<.5?(u.push(m[0]),u.push(u[0])):(u.push(u[0]),u.push(m[0])),!1,$(statusText).empty().removeClass().append("you win.").addClass("correct"),$("#cardA .val.active").addClass("wrong"),$("#cardB .val.active").addClass("correct"),handleAudio("correct_audio")):(m[0].addDuelResult("tie"),u[0].addDuelResult("tie"),m.push(m[0]),u.push(u[0]),$(statusText).empty().append("it's a tie.").removeClass("correct wrong"),$("#cardA .val.active").addClass("tie"),$("#cardB .val.active").addClass("tie"),handleAudio("tie_audio")),m.shift(),u.shift(),$(laba).text("cards ai (x): "+m.length),$(labb).text("cards user (y): "+u.length),$(statusText).addClass("active")},1400).delay(function(){$(".val").removeClass("active wrong correct tie"),0==m.length?$("#cardA").hide():0==u.length&&$("#cardB").hide(),$(".card-container").removeClass("active")},800).delay(function(){$(statusText).removeClass("active"),updateCardLengthGraphicView(m.length,u.length)},200).delay(function(){0==m.length?($(".end-game__correct .numOfUserActions").text("number of user actions: "+o),$(".end-game__correct").addClass("active")):0==u.length?($(".end-game__wrong .numOfUserActions").text("number of user actions: "+o),$(".end-game__wrong").addClass("active")):(r(),p<h?i():h<p?c():"fromUserMove"==s?c():i())},1e3)}var s=0,d=.5,o=0;$("input[type=range]").change(function(){d=$(this).val(),$("output[name=intelligenceOutput]").val(d+"%"),d/=100}),$("#loader").removeClass("active"),$("#wrapper").removeClass("overlayed");var l,u=[],m=[];shuffle(l=fillUpcars());for(var h,p,g=l.length,f=!0,w=0;w<l.length;w++)f?(m.push(l[w]),f=!1):(u.push(l[w]),f=!0);!function(){var s=new createjs.LoadQueue;createjs.Sound.alternateExtensions=["mp3"],s.installPlugin(createjs.Sound),s.on("complete",function(s){a.resolve("sounds ready")}),s.on("error",t),s.loadFile({id:"correct_audio",src:"assets/sounds/success_01.mp3"}),s.loadFile({id:"wrong_audio",src:"assets/sounds/fail_01.mp3"}),s.loadFile({id:"tie_audio",src:"assets/sounds/urlo_01.mp3"});var a=$.Deferred();a.promise()}(),window.handleAudio=function(s){var a=createjs.Sound.play(s);"introSound"==s&&(window.audioCurrentlyPlaying=!0,a.on("complete",e))},r(),$("#cardB").addClass("active"),$(statusText).append("hit enter or click here to continue ...").addClass("active"),setTimeout(function(){$(statusText).empty().removeClass("active"),i()},200),$(document).keypress(function(s){13==s.which&&a()}),updateCardLengthGraphicView(Math.floor(g/2),Math.floor(g/2)),$(statusText).click(function(){a()})},Promise.delay=function(s,a){return a||(a=s,s=function(){}),delay(a).then(s)},Promise.prototype.delay=function(s,a){return this.then(function(){return Promise.delay(s,a)})};